@if (loading()) {
  <div class="product-detail__loading">Loading product...</div>
} @else if (error()) {
  <div class="product-detail__error">{{ error() }}</div>
} @else if (product(); as p) {
  <section class="product-detail">
    <div class="product-detail__image">
      @if (p.imageUrl) {
        <img [src]="p.imageUrl" [alt]="p.name" />
      }
    </div>
    <div class="product-detail__info">
      <span class="product-detail__type">{{ p.type }}</span>
      <h1 class="product-detail__name">{{ p.name }}</h1>
      <p class="product-detail__price">${{ p.price }} CAD</p>
      <p class="product-detail__description">{{ p.description }}</p>

      <div class="product-detail__meta">
        <div class="product-detail__meta-item">
          <span class="product-detail__meta-label">Origin</span>
          <span class="product-detail__meta-value">{{ p.originCountry }}</span>
        </div>
        <div class="product-detail__meta-item">
          <span class="product-detail__meta-label">Texture</span>
          <span class="product-detail__meta-value">{{ p.texture }}</span>
        </div>
        <div class="product-detail__meta-item">
          <span class="product-detail__meta-label">Length</span>
          <span class="product-detail__meta-value">{{ p.lengthInches }}"</span>
        </div>
      </div>

      <div class="product-detail__actions">
        <div class="product-detail__quantity">
          <button class="product-detail__qty-btn" (click)="decrementQuantity()">-</button>
          <span class="product-detail__qty-value">{{ quantity() }}</span>
          <button class="product-detail__qty-btn" (click)="incrementQuantity()">+</button>
        </div>
        <lib-button variant="primary" (click)="addToCart()">
          @if (addingToCart()) {
            ADDING...
          } @else if (addedToCart()) {
            ADDED TO CART
          } @else {
            ADD TO CART
          }
        </lib-button>
      </div>

      @if (addedToCart()) {
        <button class="product-detail__view-cart" (click)="goToCart()">View Cart</button>
      }
    </div>
  </section>
}
